conflicts: []
definition_location: /home/chase/_work/complianceascode-content/complianceascode-content/linux_os/guide/system/auditing/auditd_configure_rules/audit_file_modification/audit_rules_unsuccessful_file_modification_fchownat/rule.yml
description: 'The audit system should collect unsuccessful file ownership change

  attempts for all users and root.

  If the <tt>auditd</tt> daemon is configured

  to use the <tt>augenrules</tt> program to read audit rules during daemon

  startup (the default), add the following lines to a file with suffix

  <tt>.rules</tt> in the directory <tt>/etc/audit/rules.d</tt>.

  If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>

  utility to read audit rules during daemon startup, add the following lines to

  <tt>/etc/audit/audit.rules</tt> file.

  <pre>-a always,exit -F arch=b32 -S fchownat -F exit=-EACCES -F auid>=1000 -F auid!=unset
  -F key=unsuccesful-perm-change

  -a always,exit -F arch=b32 -S fchownat -F exit=-EPERM -F auid>=1000 -F auid!=unset
  -F key=unsuccesful-perm-change</pre>

  If the system is 64 bit then also add the following lines:

  <pre>-a always,exit -F arch=b64 -S fchownat -F exit=-EACCES -F auid>=1000 -F auid!=unset
  -F key=unsuccesful-perm-change

  -a always,exit -F arch=b64 -S fchownat -F exit=-EPERM -F auid>=1000 -F auid!=unset
  -F key=unsuccesful-perm-change</pre>'
identifiers: {}
inherited_platforms:
- audit
ocil: 'To determine if the system is configured to audit calls to the

  <code>fchownat</code> system call, run the following command:

  <pre space="preserve">$ sudo grep "fchownat" /etc/audit/audit.*</pre>

  If the system is configured to audit this activity, it will return a line.

  '
ocil_clause: no line is returned
oval_external_content: null
platform: null
platforms: !!set
  audit: null
prodtype: fedora,ol7,ol8,rhcos4,rhel7,rhel8,rhel9
rationale: 'Unsuccessful attempts to change ownership of files could be an indicator
  of malicious activity on a system. Auditing

  these events could serve as evidence of potential system compromise.'
references:
  disa: CCI-000172
  nist: AU-2(d),AU-12(c),CM-6(a)
  vmmsrg: SRG-OS-000458-VMM-001810,SRG-OS-000461-VMM-001830
requires: []
severity: medium
template:
  backends: {}
  name: audit_rules_unsuccessful_file_modification
  vars:
    name: fchownat
    syscall_grouping:
    - chown
    - fchown
    - fchownat
    - lchown
title: Record Unsuccessul Ownership Changes to Files - fchownat
warnings:
- general: 'Note that these rules can be configured in a

    number of ways while still achieving the desired effect. Here the audit rule checks
    a

    system call independently of other system calls. Grouping system calls related

    to the same event is more efficient. See the following example:

    <pre>-a always,exit -F arch=b32 -S lchown,fchown,chown,fchownat -F exit=-EACCES
    -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change</pre>'
