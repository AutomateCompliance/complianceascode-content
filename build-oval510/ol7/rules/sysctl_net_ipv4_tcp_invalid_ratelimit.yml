conflicts: []
definition_location: /home/chase/_work/complianceascode-content/complianceascode-content/linux_os/guide/system/network/network-kernel/network_host_and_router_parameters/sysctl_net_ipv4_tcp_invalid_ratelimit/rule.yml
description: 'Make sure that the system is configured to limit the maximal rate for
  sending

  duplicate acknowledgments in response to incoming TCP packets that are for

  an existing connection but that are invalid due to any of these reasons:


  (a) out-of-window sequence number, (b) out-of-window acknowledgment number,

  or (c) PAWS (Protection Against Wrapped Sequence numbers) check failure

  This measure protects against or limits effects of DoS attacks against the system.

  Set the system to implement rate-limiting measures by adding the following line
  to

  <tt>/etc/sysctl.conf</tt> or a configuration file in the <tt>/etc/sysctl.d/</tt>
  directory

  (or modify the line to have the required value):

  <pre>net.ipv4.tcp_invalid_ratelimit = <sub idref="sysctl_net_ipv4_tcp_invalid_ratelimit_value"
  /></pre>

  Issue the following command to make the changes take effect:

  <pre># sysctl --system</pre>'
identifiers: {}
inherited_platforms:
- machine
ocil: 'To verify that the operating system protects against or limits the effects
  of DoS

  attacks by ensuring implementation of rate-limiting measures

  on impacted network interfaces, run the following command:

  <pre># grep ''net.ipv4.tcp_invalid_ratelimit'' /etc/sysctl.conf /etc/sysctl.d/*</pre>

  The command should output the following line:

  <pre>/etc/sysctl.conf:net.ipv4.tcp_invalid_ratelimit = <sub idref="sysctl_net_ipv4_tcp_invalid_ratelimit_value"
  /></pre>

  The file where the line has been found can differ, but it must be either <tt>/etc/sysctl.conf</tt>

  or a file located under the <tt>/etc/sysctl.d/</tt> directory.'
ocil_clause: rate limiting of duplicate TCP acknowledgments is not configured
oval_external_content: null
platform: null
platforms: !!set
  machine: null
prodtype: ol7,ol8,rhcos4,rhel7,rhel8,rhel9,sle15,wrlinux1019
rationale: "Denial of Service (DoS) is a condition when a resource is not available\
  \ for legitimate users. When\nthis occurs, the organization either cannot accomplish\
  \ its mission or must\noperate at degraded capacity.\n<br /><br />\nThis can help\
  \ mitigate simple \u201Cack loop\u201D DoS attacks, wherein a buggy or\nmalicious\
  \ middlebox or man-in-the-middle can rewrite TCP header fields in\nmanner that causes\
  \ each endpoint to think that the other is sending invalid\nTCP segments, thus causing\
  \ each side to send an unterminating stream of\nduplicate acknowledgments for invalid\
  \ segments."
references:
  disa: CCI-002385
  nerc-cip: CIP-007-3 R4,CIP-007-3 R4.1,CIP-007-3 R4.2,CIP-007-3 R5.1
  nist: SC-5
  srg: SRG-OS-000420-GPOS-00186
  stigid: OL07-00-040510
  vmmsrg: SRG-OS-000420-VMM-001690
requires: []
severity: medium
template:
  backends: {}
  name: sysctl
  vars:
    datatype: int
    sysctlvar: net.ipv4.tcp_invalid_ratelimit
title: Configure Kernel to Rate Limit Sending of Duplicate TCP Acknowledgments
warnings: []
