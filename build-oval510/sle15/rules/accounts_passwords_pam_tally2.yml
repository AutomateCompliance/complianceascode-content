conflicts: []
definition_location: /home/chase/_work/complianceascode-content/complianceascode-content/linux_os/guide/system/accounts/accounts-pam/locking_out_password_attempts/accounts_passwords_pam_tally2/rule.yml
description: 'The SUSE Linux Enterprise 15 operating system must lock an account after
  - at most - <sub idref="var_password_pam_tally2" />

  consecutive invalid access attempts.'
identifiers:
  cce: CCE-85554-4
inherited_platforms: []
ocil: 'Check that the systems locks a user account after - at most - <tt><sub idref="var_password_pam_tally2"
  /></tt>

  consecutive failed login attempts with the following command:


  <pre># grep pam_tally2.so /etc/pam.d/common-auth

  auth required pam_tally2.so onerr=fail deny=<sub idref="var_password_pam_tally2"
  /></pre>


  If no line is returned, the line is commented out, or the line is missing

  "onerr=fail", this is a finding.

  If the line has "deny" set to a value outside of the range <pre>1-<sub idref="var_password_pam_tally2"
  /></pre>,

  this is a finding.


  Check that the system resets the failed login attempts counter after a

  successful login using the following command:


  <pre># grep pam_tally2.so /etc/pam.d/common-account

  account required pam_tally2.so deny=<sub idref="var_password_pam_tally2" /></pre>


  If the account option is missing, or commented out, this is a finding.'
ocil_clause: that is not the case
oval_external_content: null
platform: null
platforms: !!set {}
prodtype: sle12,sle15,ubuntu2004
rationale: 'By limiting the number of failed logon attempts, the risk of unauthorized

  system access via user password guessing, otherwise known as brute-force

  attacks, is reduced. Limits are imposed by locking the account.


  To configure the operating system to lock an account after three

  unsuccessful consecutive access attempts using <tt>pam_tally2.so</tt>,

  modify the content of both <tt>/etc/pam.d/common-auth</tt> and

  <tt>/etc/pam.d/common-account</tt> as follows:

  <br /><br />

  <ul>

  <li> add or modify the <tt>pam_tally2.so</tt> module line in

  <tt>/etc/pam.d/common-auth</tt> to ensure both <tt>onerr=fail</tt> and

  <tt>deny=<sub idref="var_password_pam_tally2" /></tt> are present. For example:

  <pre>auth required pam_tally2.so onerr=fail silent audit deny=<sub idref="var_password_pam_tally2"
  /></pre></li>

  <li> add or modify the following line in <tt>/etc/pam.d/common-account</tt>:

  <pre>account required pam_tally2.so</pre></li>

  </ul>'
references:
  cis: 5.3.2
  disa: CCI-000044
  srg: SRG-OS-000021-GPOS-00005
  stigid: SLES-15-020010
requires: []
severity: medium
template: null
title: Set Deny For Failed Password Attempts
warnings: []
