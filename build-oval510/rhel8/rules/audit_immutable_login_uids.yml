conflicts: []
definition_location: /home/chase/_work/complianceascode-content/complianceascode-content/linux_os/guide/system/auditing/policy_rules/audit_immutable_login_uids/rule.yml
description: "Configure kernel to prevent modification of login UIDs once they are\
  \ set. Changing login UUIDs while this configuration is enforced requires special\
  \ capabilities which are not available to unprivileged users.   \n\nThe following\
  \ rules configure audit as described above:\n<pre>## Make the loginuid immutable.\
  \ This prevents tampering with the auid.\n--loginuid-immutable\n\n</pre>\n\nThe\
  \ <tt>Audit</tt> provides pre-configured  rules in <tt>/usr/share/audit/sample-rules</tt>.\
  \ The above content can be found in <tt>/usr/share/audit/sample-rules/11-loginuid.rules</tt>.\n\
  To deploy this configuration, it is recommended to copy it over to the <tt>/etc/audit/rules.d/</tt>\
  \ directory:\n<pre>\ncp /usr/share/audit/sample-rules/11-loginuid.rules /etc/audit/rules.d/\n\
  </pre>\n\nLoad new Audit rules into kernel by running:\n<pre>augenrules --load</pre>"
identifiers:
  cce: CCE-82828-5
inherited_platforms:
- machine
ocil: 'To verify that the <tt>Audit</tt> is correctly configured according to recommended
  rules, check the content of the file with the following command:

  <pre>cat /etc/audit/rules.d/11-loginuid.rules</pre>

  The output has to be exactly as follows:

  <pre>## Make the loginuid immutable. This prevents tampering with the auid.

  --loginuid-immutable


  </pre>'
ocil_clause: the file does not exist or the content differs
oval_external_content: null
platform: null
platforms: !!set
  machine: null
prodtype: ol8,rhcos4,rhel8,rhel9
rationale: 'If modification of login UIDs is not prevented, they can be changed by
  unprivileged users and make auditing complicated or impossible. '
references:
  disa: CCI-000162
  nist: AU-2(a)
  ospp: FAU_GEN.1.1.c
  srg: SRG-OS-000462-GPOS-00206,SRG-OS-000475-GPOS-00220,SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029
  stigid: RHEL-08-030122
requires: []
severity: medium
template:
  backends: {}
  name: audit_file_contents
  vars:
    contents: '## Make the loginuid immutable. This prevents tampering with the auid.

      --loginuid-immutable


      '
    filepath: /etc/audit/rules.d/11-loginuid.rules
title: Configure immutable Audit login UIDs
warnings: []
