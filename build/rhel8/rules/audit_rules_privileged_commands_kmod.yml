conflicts: []
definition_location: /home/chase/_work/complianceascode-content/complianceascode-content/linux_os/guide/system/auditing/auditd_configure_rules/audit_privileged_commands/audit_rules_privileged_commands_kmod/rule.yml
description: 'At a minimum, the audit system should collect the execution of

  privileged commands for all users and root. If the <tt>auditd</tt> daemon is

  configured to use the <tt>augenrules</tt> program to read audit rules during

  daemon startup (the default), add a line of the following form to a file with

  suffix <tt>.rules</tt> in the directory <tt>/etc/audit/rules.d</tt>:

  <pre>-a always,exit -F path=/usr/bin/kmod -F perm=x -F auid>=1000 -F auid!=unset
  -F key=privileged</pre>

  If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>

  utility to read audit rules during daemon startup, add a line of the following

  form to <tt>/etc/audit/audit.rules</tt>:

  <pre>-a always,exit -F path=/usr/bin/kmod -F perm=x -F auid>=1000 -F auid!=unset
  -F key=privileged</pre>'
identifiers:
  cce: CCE-89455-0
inherited_platforms:
- audit
ocil: 'To verify that auditing of privileged command use is configured, run the

  following command:


  <pre># sudo grep kmod /etc/audit/audit.rules

  -a always,exit -F path=/usr/bin/kmod -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged</pre>


  If the system is configured to audit the execution of the module management

  program "kmod", the command will return a line. If the command does not

  return a line, or the line is commented out, this is a finding.'
ocil_clause: it is not the case
oval_external_content: null
platform: machine
platforms: !!set
  machine: null
prodtype: rhel8,sle12,sle15,ubuntu2004
rationale: 'Without generating audit records that are specific to the security and

  mission needs of the organization, it would be difficult to establish,

  correlate, and investigate the events relating to an incident or identify

  those responsible for one.


  Audit records can be generated from various components within the

  information system (e.g., module or policy filter).'
references:
  disa: CCI-000130,CCI-000169,CCI-000172,CCI-002884
  nist: AU-3,AU-3.1,AU-12(a),AU-12.1(ii),AU-12.1(iv)AU-12(c),MA-4(1)(a)
  srg: SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215,SRG-OS-000471-GPOS-00216,SRG-OS-000477-GPOS-00222
  stigid: RHEL-08-030580
requires: []
severity: medium
template:
  backends: {}
  name: audit_rules_privileged_commands
  vars:
    path: /usr/bin/kmod
title: Ensure auditd Collects Information on the Use of Privileged Commands - kmod
warnings: []
