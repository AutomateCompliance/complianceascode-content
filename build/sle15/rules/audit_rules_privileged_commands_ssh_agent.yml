conflicts: []
definition_location: /home/chase/_work/complianceascode-content/complianceascode-content/linux_os/guide/system/auditing/auditd_configure_rules/audit_privileged_commands/audit_rules_privileged_commands_ssh_agent/rule.yml
description: 'At a minimum, the audit system should collect any execution attempt

  of the <tt>ssh-agent</tt> command for all users and root. If the <tt>auditd</tt>

  daemon is configured to use the <tt>augenrules</tt> program to read audit rules

  during daemon startup (the default), add the following lines to a file with suffix

  <tt>.rules</tt> in the directory <tt>/etc/audit/rules.d</tt>:

  <pre>-a always,exit -F path=/usr/bin/ssh-agent -F perm=x -F auid&gt;=1000 -F auid!=unset
  -k privileged-ssh-agent</pre>

  If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>

  utility to read audit rules during daemon startup, add the following lines to

  <tt>/etc/audit/audit.rules</tt> file:

  <pre>-a always,exit -F path=/usr/bin/ssh-agent -F perm=x -F auid&gt;=1000 -F auid!=unset
  -k privileged-ssh-agent</pre>'
identifiers:
  cce: CCE-85590-8
inherited_platforms:
- audit
ocil: 'To verify that execution of the command is being audited, run the following
  command:

  <pre>$ sudo grep "path=/usr/bin/ssh-agent" /etc/audit/audit.rules /etc/audit/rules.d/*</pre>

  The output should return something similar to:

  <pre>-a always,exit -F path=/usr/bin/ssh-agent -F perm=x -F auid&gt;=1000 -F auid!=unset
  -k privileged-ssh-agent</pre>'
ocil_clause: it is not the case
oval_external_content: null
platform: null
platforms: !!set
  audit: null
prodtype: rhel8,sle12,sle15,ubuntu2004
rationale: 'Without generating audit records that are specific to the security and

  mission needs of the organization, it would be difficult to establish,

  correlate, and investigate the events relating to an incident or identify

  those responsible for one.


  Audit records can be generated from various components within the

  information system (e.g., module or policy filter).'
references:
  disa: CCI-000130,CCI-000169,CCI-000172
  srg: SRG-OS-000037-GPOS-00015,SRG-OS-000042-GPOS-00020,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215
  stigid: SLES-15-030370
requires: []
severity: medium
template:
  backends: {}
  name: audit_rules_privileged_commands
  vars:
    path: /usr/bin/ssh-agent
title: Record Any Attempts to Run ssh-agent
warnings: []
