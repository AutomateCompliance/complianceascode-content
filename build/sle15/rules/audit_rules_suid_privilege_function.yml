conflicts: []
definition_location: /home/chase/_work/complianceascode-content/complianceascode-content/linux_os/guide/system/auditing/auditd_configure_rules/audit_rules_suid_privilege_function/rule.yml
description: 'Verify the system generates an audit record when privileged functions
  are executed.

  <pre># grep -iw execve <tt>/etc/audit/audit.rules</tt></pre>


  <pre>-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k setuid</pre>

  <pre>-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k setuid</pre>

  <pre>-a always,exit -F arch=b32 -S execve -C gid!=egid -F egid=0 -k setgid</pre>

  <pre>-a always,exit -F arch=b64 -S execve -C gid!=egid -F egid=0 -k setgid</pre>


  If both the "b32" and "b64" audit rules for "SUID" files are not defined, this is
  a finding.

  If both the "b32" and "b64" audit rules for "SGID" files are not defined, this is
  a finding.'
identifiers:
  cce: CCE-85611-2
inherited_platforms:
- audit
ocil: 'Add or update the following rules in "<tt>/etc/audit/rules.d/audit.rules</tt>":


  <pre>-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k setuid</pre>

  <pre>-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k setuid</pre>

  <pre>-a always,exit -F arch=b32 -S execve -C gid!=egid -F egid=0 -k setgid</pre>

  <pre>-a always,exit -F arch=b64 -S execve -C gid!=egid -F egid=0 -k setgid</pre>


  The audit daemon must be restarted for the changes to take effect.


  <pre># sudo systemctl restart <tt>auditd.service</tt></pre>'
ocil_clause: it is not the case
oval_external_content: null
platform: machine
platforms: !!set
  machine: null
prodtype: rhel7,rhel8,sle12,sle15,ubuntu2004
rationale: 'Misuse of privileged functions, either intentionally or unintentionally
  by

  authorized users, or by unauthorized external entities that have

  compromised information system accounts, is a serious and ongoing concern

  and can have significant adverse impacts on organizations. Auditing the use

  of privileged functions is one way to detect such misuse and identify the

  risk from insider threats and the advanced persistent threat.'
references:
  disa: CCI-001814,CCI-001882,CCI-001889,CCI-001880,CCI-001881,CCI-001878,CCI-001879,CCI-001875,CCI-001877,CCI-001914,CCI-002234
  nist: CM-5(1),AU-7(a),AU-7(b),AU-8(b),AU-12(3),AC-6(9)
  srg: SRG-OS-000326-GPOS-00126,SRG-OS-000327-GPOS-00127,SRG-OS-000337-GPOS-00129,SRG-OS-000348-GPOS-00136,SRG-OS-000349-GPOS-00137,SRG-OS-000350-GPOS-00138,SRG-OS-000351-GPOS-00139,SRG-OS-000352-GPOS-00140,SRG-OS-000353-GPOS-00141,SRG-OS-000354-GPOS-00142,SRG-OS-000358-GPOS-00145,SRG-OS-000359-GPOS-00146,SRG-OS-000365-GPOS-00152
  stigid: SLES-15-030640
requires: []
severity: medium
template: null
title: Record Events When Privileged Executables Are Run
warnings:
- general: 'Note that these rules can be configured in a

    number of ways while still achieving the desired effect.'
