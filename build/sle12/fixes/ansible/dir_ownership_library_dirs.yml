# platform = multi_platform_sle
# reboot = false
# strategy = restrict
# complexity = medium
# disruption = medium
- name: Read list libraries without root ownership
  find:
    paths:
      - /usr/lib
      - /usr/lib64
      - /lib
      - /lib64
    file_type: directory
  register: library_dirs_not_owned_by_root
  tags:
    - CCE-83236-0
    - DISA-STIG-SLES-12-010874
    - NIST-800-53-CM-5(6)
    - NIST-800-53-CM-5(6).1
    - dir_ownership_library_dirs
    - medium_complexity
    - medium_disruption
    - medium_severity
    - no_reboot_needed
    - restrict_strategy

- name: Set ownership of system library dirs to root
  file:
    path: '{{ item.path }}'
    owner: root
    state: directory
    mode: '{{ item.mode }}'
  with_items: '{{ library_dirs_not_owned_by_root.files }}'
  when: library_dirs_not_owned_by_root.matched > 0
  tags:
    - CCE-83236-0
    - DISA-STIG-SLES-12-010874
    - NIST-800-53-CM-5(6)
    - NIST-800-53-CM-5(6).1
    - dir_ownership_library_dirs
    - medium_complexity
    - medium_disruption
    - medium_severity
    - no_reboot_needed
    - restrict_strategy
